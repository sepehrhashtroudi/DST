100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [01:14<00:00,  8.07it/s]
[59 38 14 ..., 27 10 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.44834384858044163
joint_acc:0.44834384858044163
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 118.48it/s]
[0 0 0 ..., 0 0 0]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.6731470230862697
test_joint_acc:0.6731470230862697
Epoch 1
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [01:08<00:00,  8.75it/s]
[ 0 23  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.706230283911672
joint_acc:0.706230283911672
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 121.43it/s]
[ 0  0  0 ..., 11 21 21]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.6913730255164034
test_joint_acc:0.6913730255164034
Epoch 2
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [01:05<00:00,  9.23it/s]
[11  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.751577287066246
joint_acc:0.751577287066246
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:04<00:00, 95.54it/s]
[ 0  0  0 ..., 11 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.7260024301336574
test_joint_acc:0.7260024301336574
Epoch 3
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [01:02<00:00,  9.58it/s]
[ 0 10  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.7890378548895899
joint_acc:0.7890378548895899
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.56it/s]
[ 0  0  0 ..., 11 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.7618469015795869
test_joint_acc:0.7618469015795869
Epoch 4
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.12it/s]
[11  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.8221608832807571
joint_acc:0.8221608832807571
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 129.63it/s]
[ 0  0  0 ..., 11 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.7861482381530984
test_joint_acc:0.7861482381530984
Epoch 5
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 11.07it/s]
[ 0  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.8497634069400631
joint_acc:0.8497634069400631
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 129.80it/s]
[ 0  0  0 ..., 33 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.764277035236938
test_joint_acc:0.764277035236938
Epoch 6
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.94it/s]
[40  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.8675078864353313
joint_acc:0.8675078864353313
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 125.74it/s]
[ 0  0  0 ..., 33 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8153098420413123
test_joint_acc:0.8153098420413123
Epoch 7
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:55<00:00, 10.79it/s]
[34  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.8797318611987381
joint_acc:0.8797318611987381
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 128.73it/s]
[ 0  0  0 ..., 30 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8201701093560145
test_joint_acc:0.8201701093560145
Epoch 8
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:55<00:00, 10.89it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.8915615141955836
joint_acc:0.8915615141955836
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.77it/s]
[ 0  0  0 ...,  4 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8408262454434994
test_joint_acc:0.8408262454434994
Epoch 9
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:55<00:00, 10.90it/s]
[ 4  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9045741324921136
joint_acc:0.9045741324921136
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:02<00:00, 134.22it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8377885783718104
test_joint_acc:0.8377885783718104
Epoch 10
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.14it/s]
[28  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.916403785488959
joint_acc:0.916403785488959
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:02<00:00, 133.38it/s]
[ 0  0  0 ..., 33 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8535844471445929
test_joint_acc:0.8535844471445929
Epoch 11
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.15it/s]
[45  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9250788643533123
joint_acc:0.9250788643533123
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:02<00:00, 133.91it/s]
[ 0  0  0 ..., 45 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8444714459295262
test_joint_acc:0.8444714459295262
Epoch 12
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.12it/s]
[ 4  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9270504731861199
joint_acc:0.9270504731861199
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.88it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8547995139732685
test_joint_acc:0.8547995139732685
Epoch 13
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 11.03it/s]
[28  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9345425867507886
joint_acc:0.9345425867507886
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.96it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8614823815309842
test_joint_acc:0.8614823815309842
Epoch 14
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 11.02it/s]
[28  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9404574132492114
joint_acc:0.9404574132492114
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.64it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8657351154313487
test_joint_acc:0.8657351154313487
Epoch 15
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.93it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9511041009463722
joint_acc:0.9511041009463722
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.39it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8724179829890644
test_joint_acc:0.8724179829890644
Epoch 16
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.95it/s]
[28  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9558359621451105
joint_acc:0.9558359621451105
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.88it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8718104495747266
test_joint_acc:0.8718104495747266
Epoch 17
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.94it/s]
[20  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9605678233438486
joint_acc:0.9605678233438486
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.58it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8772782503037667
test_joint_acc:0.8772782503037667
Epoch 18
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.98it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9637223974763407
joint_acc:0.9637223974763407
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.91it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8857837181044957
test_joint_acc:0.8857837181044957
Epoch 19
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.91it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9696372239747634
joint_acc:0.9696372239747634
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.24it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8845686512758202
test_joint_acc:0.8845686512758202
Epoch 20
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.91it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9700315457413249
joint_acc:0.9700315457413249
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.09it/s]
[ 0  0  0 ..., 45 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8754556500607533
test_joint_acc:0.8754556500607533
Epoch 21
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.93it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.972397476340694
joint_acc:0.972397476340694
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.08it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8900364520048603
test_joint_acc:0.8900364520048603
Epoch 22
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.96it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9787066246056783
joint_acc:0.9787066246056783
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.78it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8876063183475091
test_joint_acc:0.8876063183475091
Epoch 23
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.93it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9727917981072555
joint_acc:0.9727917981072555
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.95it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8815309842041312
test_joint_acc:0.8815309842041312
Epoch 24
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.95it/s]
[28  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9763406940063092
joint_acc:0.9763406940063092
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.21it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8876063183475091
test_joint_acc:0.8876063183475091
Epoch 25
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.96it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9771293375394322
joint_acc:0.9771293375394322
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.30it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9003645200486027
test_joint_acc:0.9003645200486027
Epoch 26
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.96it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9779179810725552
joint_acc:0.9779179810725552
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 131.86it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8955042527339003
test_joint_acc:0.8955042527339003
Epoch 27
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:56<00:00, 10.57it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9802839116719243
joint_acc:0.9802839116719243
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.34it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8924665856622114
test_joint_acc:0.8924665856622114
Epoch 28
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:55<00:00, 10.76it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9798895899053628
joint_acc:0.9798895899053628
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.23it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8930741190765492
test_joint_acc:0.8930741190765492
Epoch 29
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:55<00:00, 10.75it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9830441640378549
joint_acc:0.9830441640378549
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.57it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9034021871202916
test_joint_acc:0.9034021871202916
Epoch 30
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.97it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9818611987381703
joint_acc:0.9818611987381703
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 128.36it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8991494532199271
test_joint_acc:0.8991494532199271
Epoch 31
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:56<00:00, 10.60it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9798895899053628
joint_acc:0.9798895899053628
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 106.92it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9040097205346294
test_joint_acc:0.9040097205346294
Epoch 32
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [01:02<00:00,  9.64it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9814668769716088
joint_acc:0.9814668769716088
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 124.45it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8955042527339003
test_joint_acc:0.8955042527339003
Epoch 33
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:56<00:00, 10.53it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9818611987381703
joint_acc:0.9818611987381703
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 128.64it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9058323207776428
test_joint_acc:0.9058323207776428
Epoch 34
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:56<00:00, 10.64it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9838328075709779
joint_acc:0.9838328075709779
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 124.67it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.905224787363305
test_joint_acc:0.905224787363305
Epoch 35
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:56<00:00, 10.68it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9842271293375394
joint_acc:0.9842271293375394
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 122.92it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8997569866342648
test_joint_acc:0.8997569866342648
Epoch 36
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 10.95it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9858044164037855
joint_acc:0.9858044164037855
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 130.45it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9003645200486027
test_joint_acc:0.9003645200486027
Epoch 37
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.26it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9830441640378549
joint_acc:0.9830441640378549
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.33it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.905224787363305
test_joint_acc:0.905224787363305
Epoch 38
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 11.10it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9826498422712934
joint_acc:0.9826498422712934
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 127.23it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8869987849331713
test_joint_acc:0.8869987849331713
Epoch 39
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.11it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9802839116719243
joint_acc:0.9802839116719243
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 125.33it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8851761846901579
test_joint_acc:0.8851761846901579
Epoch 40
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:54<00:00, 11.06it/s]
[21  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9814668769716088
joint_acc:0.9814668769716088
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 132.87it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.8955042527339003
test_joint_acc:0.8955042527339003
Epoch 41
Training =>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 600/600 [00:53<00:00, 11.24it/s]
[ 2  3  3 ..., 27 27 27]
[ 2  3  3 ..., 27 27 27]
food_acc:0.9826498422712934
joint_acc:0.9826498422712934
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [00:03<00:00, 126.29it/s]
[ 0  0  0 ..., 40 40 40]
[ 0  0  0 ..., 40 40 40]
test_food_acc:0.9040097205346294
test_joint_acc:0.9040097205346294
Epoch 42
Training =>
 51%|█████████████████████████████████████████████████████████████▉  


sent_input = Input(shape=(None,), name='main_in')
x = Embedding(output_dim=300, input_dim=n_vocab)(sent_input)

lstm_out = Bidirectional(LSTM(units=150, return_sequences=False))(x)
lstm_out = Dense(150, activation='relu',name='lstm_out')(lstm_out)

bs_input_food = Input(shape=(food_nb_classes,), name='bs_in_food')
bs_input_area = Input(shape=(area_nb_classes,), name='bs_in_area')
bs_input_price = Input(shape=(price_nb_classes,), name='bs_in_price')


bs_out_food_joined = concatenate([lstm_out, bs_input_food])
bs_out_food_joined = Dense(food_nb_classes, activation='relu')(bs_out_food_joined)
bs_out_food_joined = Dense(50, activation='relu')(bs_out_food_joined)
bs_out_food_joined = Dropout(0.25)(bs_out_food_joined)
bs_out_food_joined = Dense(food_nb_classes, activation='softmax', name='main_out')(bs_out_food_joined)
